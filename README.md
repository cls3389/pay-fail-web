# æ‰£æ¬¾å¤±è´¥ä¿¡æ¯å¤„ç†å·¥å…· - Webç‰ˆæœ¬

åŸºäºåŸå§‹Excelå¤„ç†å·¥å…·å¼€å‘çš„Webåº”ç”¨ç‰ˆæœ¬ï¼Œä¸“ä¸ºæœåŠ¡å™¨éƒ¨ç½²å’Œå¤šç”¨æˆ·åœ¨çº¿ä½¿ç”¨è®¾è®¡ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸŒ **Webç•Œé¢**: ç°ä»£åŒ–çš„æµè§ˆå™¨æ“ä½œç•Œé¢ï¼Œæ”¯æŒå¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨
- ğŸ“Š **Excelæ–‡ä»¶å¤„ç†**: åœ¨çº¿ä¸Šä¼ å’Œå¤„ç†æ‰£æ¬¾å¤±è´¥ä¿¡æ¯Excelæ–‡ä»¶
- ğŸ” **æ•°æ®é€è§†**: æŒ‰ç›´è¥ä¸­å¿ƒã€å›¢é˜Ÿã€ä¸šåŠ¡ç»ç†è¿›è¡Œæ™ºèƒ½åˆ†ç»„åˆ†æ
- ğŸ“‹ **åœ¨çº¿é¢„è§ˆ**: å®æ—¶é¢„è§ˆå¤„ç†ç»“æœï¼Œæ— éœ€ä¸‹è½½æŸ¥çœ‹
- ğŸ“¥ **æ–‡ä»¶ä¸‹è½½**: ä¸€é”®ä¸‹è½½å®Œæ•´çš„Excelå¤„ç†ç»“æœ
- ğŸ³ **Dockeréƒ¨ç½²**: ä¸€é”®éƒ¨ç½²åˆ°ä»»ä½•æ”¯æŒDockerçš„æœåŠ¡å™¨
- ğŸ§¹ **è‡ªåŠ¨æ¸…ç†**: è‡ªåŠ¨æ¸…ç†è¶…è¿‡1å¤©çš„å¤„ç†æ–‡ä»¶ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´
- âš¡ **é«˜æ€§èƒ½**: ä¼˜åŒ–çš„å¤šè¿›ç¨‹æ¶æ„ï¼Œæ”¯æŒå¹¶å‘å¤„ç†

## å‰ç½®è¦æ±‚

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10/11ã€macOSã€Linuxã€ç¾¤æ™–NAS (DSM 7.0+)
- **ç½‘ç»œ**: èƒ½è®¿é—®GitHubå’ŒDocker Hubçš„ç½‘ç»œç¯å¢ƒ
- **ç¡¬ä»¶**: è‡³å°‘1GBå†…å­˜ï¼Œ500MBå­˜å‚¨ç©ºé—´

### è½¯ä»¶è¦æ±‚ï¼ˆæ ¹æ®éƒ¨ç½²æ–¹å¼é€‰æ‹©ï¼‰

#### Dockeréƒ¨ç½²ï¼ˆæ¨èï¼Œé€‚åˆæ‰€æœ‰ç”¨æˆ·ï¼‰
- **Docker**: æœ€æ–°ç‰ˆæœ¬çš„Docker Desktop (Windows/Mac) æˆ– Docker Engine (Linux)
- **è·å–æ–¹å¼**: 
  - Windows/Mac: [Dockerå®˜ç½‘ä¸‹è½½Docker Desktop](https://www.docker.com/products/docker-desktop)
  - ç¾¤æ™–: å¥—ä»¶ä¸­å¿ƒæœç´¢"Docker"å®‰è£…
  - Linux: `curl -fsSL https://get.docker.com | sh`

#### Pythonç›´æ¥éƒ¨ç½²ï¼ˆé€‚åˆå¼€å‘è€…ï¼‰
- **Python**: 3.11ç‰ˆæœ¬ (ä¸æ”¯æŒå…¶ä»–ç‰ˆæœ¬)
- **è·å–æ–¹å¼**: [Pythonå®˜ç½‘ä¸‹è½½](https://www.python.org/downloads/)

#### Gitï¼ˆä»£ç ç®¡ç†ï¼Œå¯é€‰ï¼‰
- ç”¨äºè·å–æœ€æ–°ä»£ç å’Œæ¥æ”¶æ›´æ–°
- **è·å–æ–¹å¼**: [Gitå®˜ç½‘ä¸‹è½½](https://git-scm.com/downloads)

---

## å¿«é€Ÿå¼€å§‹

> ğŸ’¡ **æ–°æ‰‹å»ºè®®**: å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Œæ¨èæŒ‰é¡ºåºé˜…è¯»æ¯ä¸ªéƒ¨ç½²æ–¹å¼ï¼Œé€‰æ‹©æœ€é€‚åˆä½ çš„æ–¹æ¡ˆã€‚

### ä½¿ç”¨Docker (æ¨è)

#### æ–¹å¼1ï¼šä½¿ç”¨é¢„æ„å»ºé•œåƒï¼ˆæ¨èç»™æ–°æ‰‹ï¼‰

> ğŸ¯ **é€‚åˆäººç¾¤**: ä¸æƒ³æŠ˜è…¾ï¼Œç›´æ¥ä½¿ç”¨çš„ç”¨æˆ·  
> â° **éƒ¨ç½²æ—¶é—´**: 3-5åˆ†é’Ÿ  
> ğŸ“¦ **é•œåƒå¤§å°**: ~200MB  

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œç›®å½•**
```bash
# Windowsç”¨æˆ·åœ¨CMDæˆ–PowerShellä¸­æ‰§è¡Œï¼š
mkdir excel-processor
cd excel-processor
mkdir uploads
mkdir output  
mkdir logs

# macOS/Linuxç”¨æˆ·åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š
mkdir excel-processor
cd excel-processor
mkdir -p uploads output logs
```

**ç¬¬äºŒæ­¥ï¼šæ‹‰å–å¹¶è¿è¡Œé•œåƒ**
```bash
# Linux/macOSç”¨æˆ·æ‰§è¡Œï¼š
docker run -d \
  -p 4009:4009 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/output:/app/output \
  -v $(pwd)/logs:/app/logs \
  --name excel-processor \
  --restart unless-stopped \
  ghcr.io/cls3389/koukuanshibai-web:latest

# Windowsç”¨æˆ·æ‰§è¡Œï¼š
docker run -d -p 4009:4009 -v %cd%/uploads:/app/uploads -v %cd%/output:/app/output -v %cd%/logs:/app/logs --name excel-processor --restart unless-stopped ghcr.io/cls3389/koukuanshibai-web:latest
```

**ç¬¬ä¸‰æ­¥ï¼šéªŒè¯éƒ¨ç½²**
```bash
# 1. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œ
docker ps

# 2. æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€  
curl http://localhost:4009/health
# å¦‚æœæ²¡æœ‰curlï¼Œç›´æ¥åœ¨æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:4009/health

# 3. è®¿é—®åº”ç”¨ç•Œé¢
# åœ¨æµè§ˆå™¨è¾“å…¥ï¼šhttp://localhost:4009
```

**è¯´æ˜è§£é‡Š**:
- `-d`: åå°è¿è¡Œå®¹å™¨
- `-p 4009:4009`: å°†å®¹å™¨4009ç«¯å£æ˜ å°„åˆ°æœ¬æœº4009ç«¯å£
- `-v`: æŒ‚è½½ç›®å½•ï¼Œè®©å®¹å™¨èƒ½è®¿é—®æœ¬æœºæ–‡ä»¶
- `--restart unless-stopped`: å¼€æœºè‡ªå¯åŠ¨

#### æ–¹å¼2ï¼šä½¿ç”¨Docker Composeï¼ˆæ¨èç»™ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·ï¼‰

> ğŸ¯ **é€‚åˆäººç¾¤**: éœ€è¦è‡ªå®šä¹‰é…ç½®ï¼Œæˆ–æƒ³äº†è§£é¡¹ç›®ç»“æ„çš„ç”¨æˆ·  
> â° **éƒ¨ç½²æ—¶é—´**: 5-10åˆ†é’Ÿ  
> ğŸ“ **éœ€è¦**: ä¸‹è½½é¡¹ç›®æºç   

**ç¬¬ä¸€æ­¥ï¼šè·å–é¡¹ç›®æºç **
```bash
# ä½¿ç”¨Gitå…‹éš†ï¼ˆæ¨èï¼‰
git clone https://github.com/cls3389/koukuanshibai-web.git
cd koukuanshibai-web

# æˆ–è€…æ‰‹åŠ¨ä¸‹è½½ï¼š
# 1. è®¿é—® https://github.com/cls3389/koukuanshibai-web
# 2. ç‚¹å‡»ç»¿è‰²"Code"æŒ‰é’® â†’ "Download ZIP"  
# 3. è§£å‹åˆ°ä»»æ„ç›®å½•ï¼Œè¿›å…¥è¯¥ç›®å½•
```

**ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æœåŠ¡**
```bash
# ä¸€é”®å¯åŠ¨ï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºå¿…è¦ç›®å½•ï¼‰
docker-compose up -d

# ä¸Šé¢å‘½ä»¤åšäº†ä»€ä¹ˆï¼š
# 1. è‡ªåŠ¨åˆ›å»ºuploadsã€outputã€logsç›®å½•
# 2. æ„å»ºæˆ–æ‹‰å–Dockeré•œåƒ
# 3. å¯åŠ¨WebæœåŠ¡
# 4. é…ç½®å¥åº·æ£€æŸ¥
```

**ç¬¬ä¸‰æ­¥ï¼šéªŒè¯å’Œç®¡ç†**
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f
# (æŒ‰Ctrl+Cé€€å‡ºæ—¥å¿—æŸ¥çœ‹)

# è®¿é—®åº”ç”¨ï¼šhttp://localhost:4009

# åœæ­¢æœåŠ¡  
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart
```

#### æ–¹å¼3ï¼šæœ¬åœ°æ„å»ºDockeré•œåƒ

##### Linux/macOSç”¨æˆ·ï¼š
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/cls3389/koukuanshibai-web.git
cd koukuanshibai-web

# 2. åˆ›å»ºå¿…è¦ç›®å½•ï¼ˆé‡è¦ï¼ï¼‰
mkdir -p uploads output logs

# 3. æ„å»ºé•œåƒ
docker build -t excel-processor:local .

# 4. æ£€æŸ¥é•œåƒæ„å»ºæˆåŠŸ
docker images | grep excel-processor

# 5. è¿è¡Œå®¹å™¨
docker run -d \
  -p 4009:4009 \
  -v $(pwd)/uploads:/app/uploads \
  -v $(pwd)/output:/app/output \
  -v $(pwd)/logs:/app/logs \
  --name excel-processor-local \
  --restart unless-stopped \
  excel-processor:local

# 6. éªŒè¯è¿è¡ŒçŠ¶æ€
docker ps | grep excel-processor
curl http://localhost:4009/health

# 7. æŸ¥çœ‹æ—¥å¿—
docker logs excel-processor-local

# 8. åœæ­¢å’Œæ¸…ç†
docker stop excel-processor-local
docker rm excel-processor-local
```

##### Windowsç”¨æˆ·ï¼ˆPowerShell/CMDï¼‰ï¼š
```cmd
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/cls3389/koukuanshibai-web.git
cd koukuanshibai-web

# 2. åˆ›å»ºå¿…è¦ç›®å½•
mkdir uploads
mkdir output  
mkdir logs

# 3. æ„å»ºé•œåƒ
docker build -t excel-processor:local .

# 4. è¿è¡Œå®¹å™¨
docker run -d ^
  -p 4009:4009 ^
  -v %cd%/uploads:/app/uploads ^
  -v %cd%/output:/app/output ^
  -v %cd%/logs:/app/logs ^
  --name excel-processor-local ^
  --restart unless-stopped ^
  excel-processor:local

# 5. éªŒè¯è¿è¡Œ
docker ps
curl http://localhost:4009/health

# è®¿é—®åº”ç”¨ï¼šhttp://localhost:4009
```

##### æ„å»ºå‚æ•°ä¼˜åŒ–ï¼š
```bash
# åŠ é€Ÿæ„å»ºï¼ˆä½¿ç”¨buildkitï¼‰
DOCKER_BUILDKIT=1 docker build -t excel-processor:local .

# å¤šå¹³å°æ„å»ºï¼ˆéœ€è¦buildxï¼‰
docker buildx build --platform linux/amd64,linux/arm64 -t excel-processor:local .

# æ„å»ºæ—¶æŒ‡å®šä»£ç†ï¼ˆå›½å†…ç”¨æˆ·ï¼‰
docker build --build-arg HTTP_PROXY=http://proxy:8080 -t excel-processor:local .
```

##### æ•…éšœæ’æŸ¥ï¼š
```bash
# æ£€æŸ¥æ„å»ºæ—¥å¿—
docker build -t excel-processor:local . 2>&1 | tee build.log

# æ£€æŸ¥å®¹å™¨æ—¥å¿—
docker logs excel-processor-local

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it excel-processor-local sh

# æ£€æŸ¥å¥åº·çŠ¶æ€
curl -v http://localhost:4009/health
```

### ç¾¤æ™–NASéƒ¨ç½²ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰

> ğŸ  **é€‚åˆäººç¾¤**: ç¾¤æ™–NASç”¨æˆ·ï¼Œæƒ³åœ¨å®¶åº­ç½‘ç»œå†…éƒ¨ç½²  
> âš™ï¸ **å‰ç½®æ¡ä»¶**: ç¾¤æ™–DSM 7.0+ï¼Œå¼€å¯SSHæœåŠ¡  
> ğŸ“º **è®¿é—®æ–¹å¼**: å±€åŸŸç½‘å†…æ‰€æœ‰è®¾å¤‡éƒ½èƒ½è®¿é—®  

#### å‡†å¤‡å·¥ä½œï¼ˆå¿…è¯»ï¼ï¼‰

**ç¬¬ä¸€æ­¥ï¼šå¼€å¯SSHæœåŠ¡**
1. ç™»å½•ç¾¤æ™–ç®¡ç†ç•Œé¢
2. æ§åˆ¶é¢æ¿ â†’ ç»ˆç«¯æœºå’ŒSNMP
3. å‹¾é€‰"å¯åŠ¨SSHåŠŸèƒ½"ï¼Œç«¯å£ä¿æŒ22
4. ç‚¹å‡»åº”ç”¨

**ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…è¦å¥—ä»¶**
```
å¥—ä»¶ä¸­å¿ƒæœç´¢å¹¶å®‰è£…ï¼š
- Dockerï¼ˆæ¨èæ–¹å¼1éœ€è¦ï¼‰
- Python 3.11ï¼ˆæ¨èæ–¹å¼2éœ€è¦ï¼‰  
- Git Serverï¼ˆå¯é€‰ï¼Œç”¨äºä»£ç ç®¡ç†ï¼‰
```

#### æ–¹å¼1ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

> ğŸ¯ **é€‚åˆ**: ä¸æƒ³å®‰è£…Pythonç¯å¢ƒçš„ç”¨æˆ·  
> ğŸ”§ **ç®¡ç†**: å›¾å½¢ç•Œé¢ç®¡ç†ï¼Œé‡å¯è‡ªå¯åŠ¨  

**ç¬¬ä¸€æ­¥ï¼šSSHè¿æ¥ç¾¤æ™–**
```bash
# æ›¿æ¢your-nas-ipä¸ºä½ çš„ç¾¤æ™–IPåœ°å€
# ä¾‹å¦‚ï¼šssh admin@192.168.1.100
ssh admin@your-nas-ip

# è¾“å…¥ç®¡ç†å‘˜å¯†ç åè¿›å…¥å‘½ä»¤è¡Œ
```

**ç¬¬äºŒæ­¥ï¼šè·å–é¡¹ç›®ä»£ç **
```bash
# å»ºè®®åœ¨homesç›®å½•ä¸‹æ“ä½œ
cd /volume1/homes/admin

# é¦–æ¬¡éƒ¨ç½²ï¼šä¸‹è½½é¡¹ç›®ä»£ç 
git clone https://github.com/cls3389/koukuanshibai-web.git
cd koukuanshibai-web

# æŸ¥çœ‹é¡¹ç›®æ–‡ä»¶
ls -la
# åº”è¯¥çœ‹åˆ°dsmæ–‡ä»¶å¤¹å’Œå„ç§é…ç½®æ–‡ä»¶
```

**ç¬¬ä¸‰æ­¥ï¼šDockerä¸€é”®éƒ¨ç½²**
```bash
# è¿è¡Œéƒ¨ç½²è„šæœ¬
./dsm/docker-start.sh

# è„šæœ¬ä¼šè¯¢é—®ï¼šæ˜¯å¦æ‹‰å–æœ€æ–°ä»£ç ï¼Ÿ(y/Nï¼Œ5ç§’åè‡ªåŠ¨è·³è¿‡)
# æ–°æ‰‹å»ºè®®ï¼šç›´æ¥æŒ‰å›è½¦è·³è¿‡ï¼Œä½¿ç”¨å½“å‰ä»£ç 

# ç­‰å¾…çœ‹åˆ°ï¼šâœ… å®¹å™¨å¯åŠ¨æˆåŠŸ
# å’Œæ˜¾ç¤ºçš„è®¿é—®åœ°å€
```

**ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²**
```bash
# æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
./dsm/docker-status.sh

# åº”è¯¥çœ‹åˆ°ï¼š
# âœ… DockeræœåŠ¡æ­£å¸¸
# âœ… åº”ç”¨å“åº”æ­£å¸¸
# ğŸŒ ç½‘ç»œè®¿é—®: http://your-nas-ip:4009
```

#### æ–¹å¼2ï¼šPythonç›´æ¥éƒ¨ç½²

> ğŸ¯ **é€‚åˆ**: ç†Ÿæ‚‰Pythonçš„ç”¨æˆ·  
> ğŸ”§ **ç‰¹ç‚¹**: ç›´æ¥è¿è¡Œï¼Œèµ„æºå ç”¨æ›´å°‘  

**å‡†å¤‡ï¼šå®‰è£…Python 3.11**
- å¥—ä»¶ä¸­å¿ƒæœç´¢"Python 3.11"å®‰è£…
- ç­‰å¾…å®‰è£…å®Œæˆï¼ˆçº¦5-10åˆ†é’Ÿï¼‰

**éƒ¨ç½²æ­¥éª¤ï¼š**
```bash
# è¿æ¥SSH
ssh admin@your-nas-ip
cd /volume1/homes/admin

# ä¸‹è½½ä»£ç ï¼ˆå¦‚æœæ²¡æœ‰çš„è¯ï¼‰
git clone https://github.com/cls3389/koukuanshibai-web.git
cd koukuanshibai-web

# Pythonéƒ¨ç½²
./dsm/start.sh

# ç­‰å¾…çœ‹åˆ°ï¼šâœ… åº”ç”¨å¯åŠ¨æˆåŠŸ
# æŸ¥çœ‹çŠ¶æ€
./dsm/status.sh

# åœæ­¢æœåŠ¡ï¼ˆéœ€è¦æ—¶ï¼‰
./dsm/stop.sh
```

#### å¸¸è§é—®é¢˜è§£å†³

**é—®é¢˜1ï¼šSSHè¿æ¥å¤±è´¥**
```
è§£å†³æ–¹æ¡ˆï¼š
1. ç¡®è®¤ç¾¤æ™–IPåœ°å€æ­£ç¡®
2. ç¡®è®¤SSHæœåŠ¡å·²å¼€å¯
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. å°è¯•ç”¨adminç”¨æˆ·åç™»å½•
```

**é—®é¢˜2ï¼šDockeræœåŠ¡æœªå¯åŠ¨**
```
è§£å†³æ–¹æ¡ˆï¼š
1. ç¾¤æ™–ç®¡ç†ç•Œé¢ â†’ å¥—ä»¶ä¸­å¿ƒ
2. æ‰¾åˆ°Dockerï¼Œç‚¹å‡»è¿è¡Œ
3. ç­‰å¾…å¯åŠ¨å®Œæˆå†é‡è¯•
```

**é—®é¢˜3ï¼šç«¯å£4009æ— æ³•è®¿é—®**
```
è§£å†³æ–¹æ¡ˆï¼š
1. ç¾¤æ™–ç®¡ç†ç•Œé¢ â†’ æ§åˆ¶é¢æ¿ â†’ å®‰å…¨æ€§
2. é˜²ç«å¢™ â†’ ç¼–è¾‘è§„åˆ™
3. æ·»åŠ 4009ç«¯å£å…è®¸è®¿é—®
```

**é—®é¢˜4ï¼šPythonç‰ˆæœ¬ä¸å¯¹**
```bash
# æ£€æŸ¥Pythonç‰ˆæœ¬
python3.11 --version
# åº”è¯¥æ˜¾ç¤ºPython 3.11.x

# å¦‚æœæ²¡æœ‰ï¼Œé‡æ–°å®‰è£…Python 3.11å¥—ä»¶
```

### æœ¬åœ°å¼€å‘è°ƒè¯•

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p uploads output logs

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python excel_web.py

# è®¿é—®åœ°å€
http://localhost:4009
```

## GitHub Actions

é¡¹ç›®å·²é…ç½®GitHub Actionsè‡ªåŠ¨åŒ–æµç¨‹ï¼š

- **Docker CI**: è¯­æ³•æ£€æŸ¥ã€Dockeræ„å»ºæµ‹è¯•ã€å®¹å™¨å¯åŠ¨éªŒè¯
- **Docker Build**: è‡ªåŠ¨æ„å»ºDockeré•œåƒå¹¶å‘å¸ƒåˆ°GitHub Container Registry  
- **Multi-platform**: æ”¯æŒAMD64å’ŒARM64æ¶æ„ (linux/amd64, linux/arm64)
- **Artifact Attestation**: é•œåƒæ„å»ºæº¯æºå’Œå®‰å…¨éªŒè¯

## APIæ¥å£

- `GET /` - é¦–é¡µç•Œé¢
- `POST /upload` - æ–‡ä»¶ä¸Šä¼ å’Œå¤„ç†
- `GET /download/<filename>` - æ–‡ä»¶ä¸‹è½½
- `GET /health` - å¥åº·æ£€æŸ¥

## é¡¹ç›®ç»“æ„

```
koukuanshibai-web/
â”œâ”€â”€ .github/workflows/     # GitHub Actionsè‡ªåŠ¨åŒ–
â”‚   â”œâ”€â”€ ci.yml            # æŒç»­é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ docker-build.yml  # Dockeré•œåƒæ„å»º
â”œâ”€â”€ static/               # å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ css/              # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ js/               # JavaScriptæ–‡ä»¶
â”œâ”€â”€ templates/            # HTMLæ¨¡æ¿
â”œâ”€â”€ dsm/                  # ç¾¤æ™–NASè¿è¡Œè„šæœ¬
â”œâ”€â”€ excel_processor.py    # Excelå¤„ç†æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ excel_web.py         # Flask Webåº”ç”¨å…¥å£
â”œâ”€â”€ file_cleaner.py      # è‡ªåŠ¨æ–‡ä»¶æ¸…ç†æœåŠ¡
â”œâ”€â”€ config.py            # åº”ç”¨é…ç½®
â”œâ”€â”€ Dockerfile           # Dockeré•œåƒé…ç½®
â”œâ”€â”€ docker-compose.yml   # Dockerç¼–æ’æ–‡ä»¶
â””â”€â”€ requirements.txt     # Pythonä¾èµ–åŒ…
```

## ç¯å¢ƒå˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|--------|------|
| FLASK_PORT | 4009 | åº”ç”¨ç›‘å¬ç«¯å£ |
| SECRET_KEY | éšæœºç”Ÿæˆ | Flaskå¯†é’¥ |
| MAX_CONTENT_LENGTH | 16MB | æœ€å¤§æ–‡ä»¶å¤§å° |

## éƒ¨ç½²

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t excel-processor .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name excel-processor-web \
  -p 4009:4009 \
  -v ./uploads:/app/uploads \
  -v ./output:/app/output \
  excel-processor
```

### ä»GitHub Container Registryéƒ¨ç½²

```bash
# æ‹‰å–é•œåƒ
docker pull ghcr.io/your-username/koukuanshibai-web:latest

# è¿è¡Œ
docker run -d -p 4009:4009 ghcr.io/your-username/koukuanshibai-web:latest
```

## é¡¹ç›®è¯´æ˜

### ç‰ˆæœ¬åŒºåˆ«
- **Webç‰ˆæœ¬** (å½“å‰é¡¹ç›®): ç”¨äºæœåŠ¡å™¨éƒ¨ç½²ï¼Œæ”¯æŒå¤šç”¨æˆ·åœ¨çº¿ä½¿ç”¨
- **æœ¬åœ°ç‰ˆæœ¬**: ç‹¬ç«‹çš„exeå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé€‚åˆå•æœºä½¿ç”¨

### æŠ€æœ¯ç‰¹ç‚¹
- åŸºäºFlaskæ¡†æ¶çš„ç°ä»£Webåº”ç”¨
- Dockerå®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ”¯æŒè·¨å¹³å°
- è‡ªåŠ¨åŒ–CI/CDæµç¨‹ï¼Œæ”¯æŒå¤šCPUæ¶æ„
- æ™ºèƒ½æ–‡ä»¶æ¸…ç†ï¼Œè‡ªåŠ¨ç»´æŠ¤å­˜å‚¨ç©ºé—´

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueså’ŒPull Requestsï¼